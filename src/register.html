<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>PlanC - Registro</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="components.css">
</head>
<body>

    <div id="header-container"></div> 

    <main>
        <h1>Regístrate en Plan C</h1>
        <h2>Si ya tienes cuenta, Inicia Sesión</h2>

        <form method="post" id="registro">
            <label for="name">Nombre</label>
            <input id="name" type="text" required/>

            <label for="apellido">Apellido</label>
            <input id="apellido" type="text" required/>

            <label for="dni">DNI</label>
            <input id="dni" type="text" required/>
            <span id="dni-error" style="color: red; display: none;">DNI inválido</span>

            <label for="direccion">Dirección</label>
            <input id="direccion" type="text" required/>

            <label for="comunidad">Comunidad</label>
            <select id="comunidad" required>
                <option value="">Selecciona una comunidad</option>
            </select>

            <label for="ciudad">Ciudad</label>
            <select id="ciudad" required>
                <option value="">Selecciona una ciudad</option>
            </select>

            <label for="email">Correo Electrónico</label>
            <input id="email" type="email" required/>
            <span id="email-error" style="color: red; display: none;">Email inválido</span>

            <label for="user">Usuario</label>
            <input id="user" type="text" required/>

            <label for="passwd">Contraseña</label>
            <input id="passwd" type="password" required/>

            <label for="repeatpasswd">Repetir contraseña</label>
            <input id="repeatpasswd" type="password" required/>

            <label for="image">Imagen</label>
            <input id="image" type="file"/>

            <button type="submit">Registrar</button>
            <div class="botones">
                <button type="reset">Limpiar Formulario</button>
                <button type="button" onclick="window.location.href='login.html'">Inicio de Sesión</button>
            </div>
        </form>
    </main>

    <footer>
        <p>Creado por <b>María Fernanda Marcos Gámez y Laura Gómez Peña</b> - <i>2025</i></p>
    </footer>

    <script>
        // Cargar el header dinámicamente
        fetch("header.html")
            .then(response => response.text())
            .then(data => document.getElementById("header-container").innerHTML = data)
            .catch(error => console.error("Error al cargar el header:", error));

        // Llenar las comunidades y ciudades desde el JSON
        document.addEventListener("DOMContentLoaded", function () {
            const comunidadSelect = document.getElementById("comunidad");
            const ciudadSelect = document.getElementById("ciudad");

            // Cargar el archivo ciudades.json
            fetch("ciudades.json")
                .then(response => response.json())
                .then(data => {
                    // Llenar las comunidades
                    for (const comunidad in data) {
                        const option = document.createElement("option");
                        option.value = comunidad;
                        option.textContent = comunidad;
                        comunidadSelect.appendChild(option);
                    }

                    // Escuchar cambios en la comunidad seleccionada
                    comunidadSelect.addEventListener("change", function () {
                        const comunidadSeleccionada = comunidadSelect.value;
                        ciudadSelect.innerHTML = "<option value=''>Selecciona una ciudad</option>"; // Limpiar las ciudades

                        if (data[comunidadSeleccionada]) {
                            data[comunidadSeleccionada].forEach(ciudad => {
                                const option = document.createElement("option");
                                option.value = ciudad;
                                option.textContent = ciudad;
                                ciudadSelect.appendChild(option);
                            });
                        }
                    });
                })
                .catch(error => console.error("Error cargando ciudades:", error));
        });

        // Validar DNI
        document.getElementById("dni").addEventListener("input", function () {
            const dni = this.value.toUpperCase();
            const dniRegex = /^\d{8}[A-Z]$/;
            const dniError = document.getElementById("dni-error");

            if (dniRegex.test(dni)) {
                dniError.style.display = "none";
            } else {
                dniError.style.display = "inline";
            }
        });

        // Validar Email
        document.getElementById("email").addEventListener("input", function () {
            const email = this.value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const emailError = document.getElementById("email-error");

            if (emailRegex.test(email)) {
                emailError.style.display = "none";
            } else {
                emailError.style.display = "inline";
            }
        });
    </script>

</body>
</html>
